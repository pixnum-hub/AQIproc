<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AQI Pro Max</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">

<style>
:root{
  --bg1:#74ebd5;
  --bg2:#9face6;
  --glass:rgba(255,255,255,0.18);
  --border:rgba(255,255,255,0.4);
  --text:#111;
  --sub:#333;
  --accent:#2563eb;
}

body.dark{
  --glass:rgba(20,20,20,0.75);
  --border:#222;
  --text:#fff;
  --sub:#ccc;
  --accent:#3b82f6;
  background:#0f172a;
}

body.amoled{
  --glass:#000;
  --border:#111;
  --text:#fff;
  --sub:#aaa;
  --accent:#3b82f6;
  background:#000;
}
body.amoled .pollutant,
body.amoled .aqi-box{
  background:#000;
  border:1px solid #111;
}

body.light{
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  padding:14px;
  color:var(--text);
}

.app{
  width:100%;
  max-width:430px;
  backdrop-filter:blur(20px);
  background:var(--glass);
  border:1px solid var(--border);
  border-radius:24px;
  padding:22px 18px 18px;
  text-align:center;
  position:relative;
}

.theme-btn{
  position:absolute;
  top:12px;
  right:12px;
  width:42px;
  height:42px;
  border-radius:50%;
  border:none;
  background:var(--accent);
  color:white;
  font-size:18px;
  cursor:pointer;
}

h1{font-size:1.6rem;}

input,button{
  width:100%;
  padding:14px;
  border-radius:12px;
  margin:10px 0;
  font-size:1.05rem;
  border:1px solid rgba(255,255,255,.4);
}

input{background:rgba(255,255,255,.3);color:var(--text);}
button{background:var(--accent);color:#fff;font-weight:700;border:none;}

#aqiValue{font-size:3.2rem;font-weight:900;}
#status{font-size:1.2rem;font-weight:700;}
#updatedTime{font-size:.85rem;color:var(--sub);}

.pollutants{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-top:14px;
}

.pollutant{
  background:rgba(255,255,255,.25);
  border-radius:12px;
  padding:12px;
  font-weight:600;
}

.section-title{
  margin-top:20px;
  font-weight:800;
}

.scroll-row{
  display:flex;
  gap:10px;
  overflow-x:auto;
  margin-top:10px;
  padding-bottom:6px;
}
.scroll-row::-webkit-scrollbar{height:6px;}
.scroll-row::-webkit-scrollbar-thumb{background:var(--accent);border-radius:10px;}

.aqi-box{
  min-width:70px;
  padding:12px;
  border-radius:12px;
  font-size:1.1rem;
  font-weight:900;
  background:rgba(255,255,255,.25);
  flex-shrink:0;
}

.footer{
  margin-top:18px;
  font-size:.8rem;
  color:var(--sub);
}
</style>
</head>

<body class="light">
<div class="app">

<button class="theme-btn" onclick="cycleTheme()" id="themeIcon">‚òÄÔ∏è</button>

<h1>Air Quality Index</h1>

<input id="locationInput" placeholder="City or lat,lon">
<button onclick="checkAQI()">Check AQI</button>
<button onclick="getUserLocation()">üìç Use My Location</button>

<div id="place"></div>
<div id="aqiValue"></div>
<div id="status"></div>
<div id="updatedTime"></div>

<div class="pollutants" id="pollutants"></div>

<div class="section-title">Last 24 Hours AQI</div>
<div class="scroll-row" id="hourlyRow"></div>

<div class="section-title">7 Day Average AQI</div>
<div class="scroll-row" id="weeklyRow"></div>

<div class="footer">
¬© Manik Roy <span id="year"></span>. All Rights Reserved.
</div>

</div>

<script>
document.getElementById("year").textContent=new Date().getFullYear();

/* THEME MEMORY */
const themes=["light","dark","amoled"];
let themeIndex=0;
const savedTheme=localStorage.getItem("theme");
if(savedTheme){
  document.body.className=savedTheme;
  themeIndex=themes.indexOf(savedTheme);
}
updateThemeIcon();

function cycleTheme(){
  themeIndex=(themeIndex+1)%themes.length;
  document.body.className=themes[themeIndex];
  localStorage.setItem("theme",themes[themeIndex]);
  updateThemeIcon();
}
function updateThemeIcon(){
  themeIcon.textContent=
    themes[themeIndex]=="light"?"‚òÄÔ∏è":
    themes[themeIndex]=="dark"?"üåô":"üñ§";
}

/* AQI helpers and rest of your JS stays EXACTLY SAME as previous version */
/* (Keeping short here so message fits, but DO NOT remove your AQI code) */
</script>

<!-- SERVICE WORKER -->
<script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("sw.js")
      .then(() => console.log("Service Worker Registered"))
      .catch(err => console.log("SW registration failed", err));
  });
}
</script>

</body>
</html>
